<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-YN8ML0DX5L"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-YN8ML0DX5L'); </script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>US National Parks Weather</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#f4f4f4;color:#333;display:flex;flex-direction:column;align-items:center;padding:2rem}
    h1{font-size:2rem;margin:0 0 1rem}
    .controls{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:1rem;width:100%;max-width:1200px;justify-content:center}
    select{padding:.4rem .6rem;border:1px solid #bbb;border-radius:6px;font-size:.9rem}
    .park-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;width:100%;max-width:1200px}
    .park{background:#fff;padding:1rem;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.1);display:flex;flex-direction:column;align-items:center;text-align:center;transition:background .3s;text-decoration:none;color:inherit}
    .park:hover{background:#e9f4ff}
    .after-dark{background:#ddd}
    .park h2{font-size:1.2rem;margin:.25rem 0 .4rem}
    .icon{font-size:2rem;margin-bottom:.3rem}
    .weather{font-size:.95rem;color:#555}
    small{font-size:.8rem;color:#666}
  </style>
</head>
<body>
  <h1>Current Weather in US National Parks</h1>
  <div class="controls">
    <select id="stateFilter">
      <option value="all">All States</option>
    </select>
    <select id="sortMenu">
      <option value="name">Sort by Name (A–Z)</option>
      <option value="temp">Sort by Current Temp</option>
      <option value="high">Sort by High Temp</option>
      <option value="low">Sort by Low Temp</option>
    </select>
  </div>
  <div id="parks" class="park-list">Loading weather data...</div>

<script>
const parks=[
  {name:'Acadia',state:'ME',lat:44.35,lon:-68.21,url:'https://www.nps.gov/acad'},
  {name:'Arches',state:'UT',lat:38.7331,lon:-109.5925,url:'https://www.nps.gov/arch'},
  {name:'Badlands',state:'SD',lat:43.8554,lon:-102.3397,url:'https://www.nps.gov/badl'},
  {name:'Big Bend',state:'TX',lat:29.1275,lon:-103.2425,url:'https://www.nps.gov/bibe'},
  {name:'Bryce Canyon',state:'UT',lat:37.593,lon:-112.1871,url:'https://www.nps.gov/brca'},
  {name:'Capitol Reef',state:'UT', lat: 38.367, lon: -111.2615, url: 'https://www.nps.gov/care' },
  {name:'Carlsbad Caverns',state:'NM', lat: 32.1479, lon: -104.5567, url: 'https://www.nps.gov/cave' },
  {name:'Channel Islands',state:'CA', lat: 34.0069, lon: -119.7785, url: 'https://www.nps.gov/chis' },
  {name:'Congaree',state:'SC', lat: 33.7911, lon: -80.7812, url: 'https://www.nps.gov/cong' },
  {name:'Crater Lake',state:'OR', lat: 42.8684, lon: -122.1685, url: 'https://www.nps.gov/crla' },
  {name:'Cuyahoga Valley',state:'OH', lat: 41.2808, lon: -81.5678, url: 'https://www.nps.gov/cuva' },
  {name:'Death Valley',state:'CA', lat: 36.2461, lon: -116.8185, url: 'https://www.nps.gov/deva' },
  {name:'Denali',state:'AK', lat: 63.1148, lon: -151.1926, url: 'https://www.nps.gov/dena' },
  {name:'Dry Tortugas',state:'FL', lat: 24.6285, lon: -82.8732, url: 'https://www.nps.gov/drto' },
  {name:'Everglades',state:'FL', lat: 25.2866, lon: -80.8987, url: 'https://www.nps.gov/ever' },
  {name:'Glacier',state:'MT', lat: 48.7596, lon: -113.787, url: 'https://www.nps.gov/glac' },
  {name:'Glacier Bay',state:'AK', lat: 58.6658, lon: -136.9002, url: 'https://www.nps.gov/glba' },
  {name:'Grand Canyon',state:'AZ', lat: 36.1069, lon: -112.1129, url: 'https://www.nps.gov/grca' },
  {name:'Grand Teton',state:'WY', lat: 43.7904, lon: -110.6818, url: 'https://www.nps.gov/grte' },
  {name:'Great Basin',state:'NV', lat: 38.9833, lon: -114.3064, url: 'https://www.nps.gov/grba' },
  {name:'Great Sand Dunes',state:'CO', lat: 37.7924, lon: -105.5943, url: 'https://www.nps.gov/grsa' },
  {name:'Great Smoky Mountains',state:'NC', lat: 35.6532, lon: -83.507, url: 'https://www.nps.gov/grsm' },
  {name:'Guadalupe Mountains',state:'TX', lat: 31.923, lon: -104.8606, url: 'https://www.nps.gov/gumo' },
  {name:'Haleakalā',state:'HI', lat: 20.7204, lon: -156.1552, url: 'https://www.nps.gov/hale' },
  {name:'Hawaiʻi Volcanoes',state:'HI', lat: 19.4194, lon: -155.2885, url: 'https://www.nps.gov/havo' },
  {name:'Hot Springs',state:'AR', lat: 34.5136, lon: -93.0534, url: 'https://www.nps.gov/hosp' },
  {name:'Isle Royale',state:'MI', lat: 47.9956, lon: -88.909, url: 'https://www.nps.gov/isro' },
  {name:'Joshua Tree',state:'CA', lat: 33.8734, lon: -115.901, url: 'https://www.nps.gov/jotr' },
  {name:'Katmai',state:'AK', lat: 58.6126, lon: -155.0631, url: 'https://www.nps.gov/katm' },
  {name:'Kenai Fjords',state:'AK', lat: 59.9225, lon: -149.6493, url: 'https://www.nps.gov/kefj' },
  {name:'Kings Canyon',state:'CA', lat: 36.8879, lon: -118.5551, url: 'https://www.nps.gov/seki' },
  {name:'Kobuk Valley',state:'AK', lat: 67.3356, lon: -159.1278, url: 'https://www.nps.gov/kova' },
  {name:'Lake Clark',state:'AK', lat: 60.9675, lon: -153.8494, url: 'https://www.nps.gov/lacl' },
  {name:'Lassen Volcanic',state:'CA', lat: 40.4977, lon: -121.4207, url: 'https://www.nps.gov/lavo' },
  {name:'Mammoth Cave',state:'KY', lat: 37.186, lon: -86.1018, url: 'https://www.nps.gov/maca' },
  {name:'Mesa Verde',state:'CO', lat: 37.2309, lon: -108.4618, url: 'https://www.nps.gov/meve' },
  {name:'Mount Rainier',state:'WA', lat: 46.8523, lon: -121.7603, url: 'https://www.nps.gov/mora' },
  {name:'North Cascades',state:'WA', lat: 48.7718, lon: -121.2985, url: 'https://www.nps.gov/noca' },
  {name:'Olympic',state:'WA', lat: 47.8021, lon: -123.6044, url: 'https://www.nps.gov/olym' },
  {name:'Petrified Forest',state:'AZ', lat: 35.0658, lon: -109.7878, url: 'https://www.nps.gov/pefo' },
  {name:'Pinnacles',state:'CA', lat: 36.4906, lon: -121.1825, url: 'https://www.nps.gov/pinn' },
  {name:'Redwood',state:'CA', lat: 41.2132, lon: -124.0046, url: 'https://www.nps.gov/redw' },
  {name:'Rocky Mountain',state:'CO', lat: 40.3428, lon: -105.6836, url: 'https://www.nps.gov/romo' },
  {name:'Saguaro',state:'AZ', lat: 32.2967, lon: -111.1661, url: 'https://www.nps.gov/sagu' },
  {name:'Sequoia',state:'CA', lat: 36.4864, lon: -118.5658, url: 'https://www.nps.gov/seki' },
  {name:'Shenandoah',state:'VA', lat: 38.53, lon: -78.35, url: 'https://www.nps.gov/shen' },
  {name:'Theodore Roosevelt',state:'ND', lat: 46.979, lon: -103.5387, url: 'https://www.nps.gov/thro' },
  {name:'Virgin Islands',state:'VI', lat: 18.342, lon: -64.7501, url: 'https://www.nps.gov/viis' },
  {name:'Voyageurs',state:'MN', lat: 48.4841, lon: -92.8386, url: 'https://www.nps.gov/voya' },
  {name:'Wind Cave',state:'SD', lat: 43.568, lon: -103.4836, url: 'https://www.nps.gov/wica' },
  {name:'Wrangell-St. Elias',state:'AK', lat: 61.7194, lon: -142.9856, url: 'https://www.nps.gov/wrst' },
  {name:'Yellowstone',state:'WY', lat: 44.6, lon: -110.5, url: 'https://www.nps.gov/yell' },
  {name:'Yosemite',state:'CA',lat:37.8651,lon:-119.5383,url:'https://www.nps.gov/yose'},
  {name:'Zion',state:'UT',lat:37.2982,lon:-113.0263,url:'https://www.nps.gov/zion'}
  
];
const container=document.getElementById('parks');
const stateFilter=document.getElementById('stateFilter');
const sortMenu=document.getElementById('sortMenu');
let weatherData=[];

// populate state filter
[...new Set(parks.map(p=>p.state))].sort().forEach(st=>{
  const opt=document.createElement('option');opt.value=st;opt.textContent=st;stateFilter.appendChild(opt);
});

stateFilter.addEventListener('change',updateDisplay);
sortMenu.addEventListener('change',updateDisplay);

async function fetchWeather(){
  const reqs=parks.map(async park=>{
    try{
      const url=`https://api.open-meteo.com/v1/forecast?latitude=${park.lat}&longitude=${park.lon}&current_weather=true&daily=temperature_2m_max,temperature_2m_min,sunset&temperature_unit=fahrenheit&timezone=auto`;
      const res=await fetch(url);
      const data=await res.json();
      const now=new Date(data.current_weather.time);
      const sunset=new Date(data.daily.sunset[0]);
      return{
        ...park,
        temp:data.current_weather.temperature,
        code:data.current_weather.weathercode,
        high:data.daily.temperature_2m_max[0],
        low:data.daily.temperature_2m_min[0],
        afterDark:now>sunset
      };
    }catch(e){
      console.error('fetch error',park.name,e);
      return{...park,temp:NaN,code:null,high:NaN,low:NaN,afterDark:false,error:true};
    }
  });
  weatherData=await Promise.all(reqs);
  updateDisplay();
}

function updateDisplay(){
  const stateSel=stateFilter.value;
  const sortSel=sortMenu.value;
  let list=[...weatherData];
  if(stateSel!=='all') list=list.filter(p=>p.state===stateSel);
  list.sort((a,b)=>{
    switch(sortSel){
      case 'temp': return (b.temp||-Infinity)-(a.temp||-Infinity);
      case 'high': return (b.high||-Infinity)-(a.high||-Infinity);
      case 'low': return (a.low||Infinity)-(b.low||Infinity);
      default: return a.name.localeCompare(b.name);
    }
  });
  render(list);
}

function render(data){
  container.innerHTML='';
  if(!data.length){container.textContent='No parks match filter.';return;}
  data.forEach(p=>{
    const desc=weatherDescriptions[p.code]?.text||'Unknown';
    const icon=weatherDescriptions[p.code]?.icon||'❓';
    const el=document.createElement('a');
    el.href=p.url;el.target='_blank';
    el.className='park'+(p.afterDark?' after-dark':'');
    el.innerHTML=`<h2>${p.name}</h2><div class='icon' aria-label='${desc}'>${icon}</div><div class='weather'>${isNaN(p.temp)?'N/A':p.temp.toFixed(1)}°F<br><small>High ${isNaN(p.high)?'N/A':p.high.toFixed(1)}°F · Low ${isNaN(p.low)?'N/A':p.low.toFixed(1)}°F</small></div>`;
    container.appendChild(el);
  });
}

const weatherDescriptions={
  0:{text:'Clear',icon:'☀️'},1:{text:'Mainly clear',icon:'🌤️'},2:{text:'Partly cloudy',icon:'⛅'},3:{text:'Overcast',icon:'☁️'},
  45:{text:'Fog',icon:'🌫️'},48:{text:'Fog',icon:'🌫️'},51:{text:'Drizzle',icon:'🌦️'},53:{text:'Drizzle',icon:'🌧️'},55:{text:'Drizzle',icon:'🌧️'},
  56:{text:'Freezing drizzle',icon:'🥶'},57:{text:'Freezing drizzle',icon:'🥶'},61:{text:'Rain',icon:'🌧️'},63:{text:'Rain',icon:'🌧️'},65:{text:'Heavy rain',icon:'🌧️'},
  66:{text:'Freezing rain',icon:'🥶'},67:{text:'Freezing rain',icon:'🥶'},71:{text:'Snow',icon:'🌨️'},73:{text:'Snow',icon:'🌨️'},75:{text:'Heavy snow',icon:'❄️'},
  77:{text:'Snow grains',icon:'❄️'},80:{text:'Showers',icon:'🌦️'},81:{text:'Showers',icon:'🌧️'},82:{text:'Violent showers',icon:'⛈️'},
  85:{text:'Snow showers',icon:'🌨️'},86:{text:'Snow showers',icon:'❄️'},95:{text:'Thunder',icon:'⛈️'},96:{text:'Thunder hail',icon:'🌩️'},99:{text:'Severe thunder',icon:'🌩️'}
};

fetchWeather();
setInterval(fetchWeather,300000);
</script>
</body>
</html>
